{% extends 'vendas/base.html' %}
{% load static %}
{% block content %}
<div class="content-section">
    <div class="btn-group" role="group" aria-label="Basic example">
        <button class="btn btn-secondary" data-action="dia">dia</button>
        <button class="btn btn-secondary" data-action="mes">mes</button>
        <button class="btn btn-secondary" data-action="ano">ano</button>
    </div>


    <hr>
    <h5>Total vendido: R${{ total|floatformat:2 }}</h5>
    <h5>Quantidade de pedidos: {{ qtde_pedidos }}</h5>
    <h5>Quantidade de pedidos aprovados: {{ qtde_pedidos_aprovados }}</h5>
    <h5>Quantidade de pedidos enviados: {{ qtde_pedidos_enviados }}</h5>
    <h5>Quantidade de pedidos finalizados: {{ qtde_pedidos_finalizados }}</h5>
    <h5>Novos Revendedores: {{ revendedores }}</h5>
</div>


<script>
        var updateBtns = document.getElementsByClassName('btn-secondary')

        for (i = 0; i < updateBtns.length; i++) {
            updateBtns[i].addEventListener('click', function () {
                var action = this.dataset.action
                carregaDados(action)
        
            })
        }

        function carregaDados(action) {
        var url = '/atualizar_relatorio/'

        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': csrftoken,
            },
            body: JSON.stringify({ 'action': action, })
        })
            .then((response) => {
                return response.json();
            })
            .then((dados) => {
                location.reload()
            });
        }
    </script>
{% endblock content %}